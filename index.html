<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Multi YouTube Player – Bounded & Dark</title>
  <style>
    :root {
      --bg: #0d0d0d;
      --surface: #1a1a1a;
      --border: #333;
      --accent: #ffcc00;
      --text: #eee;
    }

    body {
      margin: 0;
      font-family: Arial, sans-serif;
      background: var(--bg);
      color: var(--text);
      overflow: hidden;
    }

    #controls {
      padding: 10px;
      background: var(--surface);
      border-bottom: 1px solid var(--border);
    }

    #urlInput {
      width: 60%;
      padding: 8px;
      background: #111;
      border: 1px solid var(--border);
      color: var(--text);
      border-radius: 4px;
    }

    #addBtn {
      padding: 8px 12px;
      margin-left: 10px;
      background: var(--accent);
      color: #000;
      border: none;
      border-radius: 4px;
      font-weight: bold;
      cursor: pointer;
    }

    #playerArea {
      position: relative;
      height: calc(100vh - 50px);
      overflow: hidden;
    }

    .video-box {
      position: absolute;
      width: 400px;
      height: 225px; /* 16:9 */
      background: black;
      border: 1px solid var(--border);
      border-radius: 6px;
      overflow: hidden;
      box-shadow: 0 0 6px rgba(0,0,0,0.6);
      transition: box-shadow 0.25s;
    }

    .video-box:hover {
      box-shadow: 0 0 12px rgba(255,255,255,0.25);
    }

    .video-box button {
      display: none;
      position: absolute;
      border: none;
      border-radius: 4px;
      color: var(--text);
      background: rgba(0,0,0,0.6);
      cursor: pointer;
      font-size: 16px;
      z-index: 10;
    }

    .video-box:hover button {
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .move-handle {
      top: 6px;
      left: 6px;
      width: 28px;
      height: 24px;
      cursor: move;
    }

    .close-btn {
      top: 6px;
      right: 6px;
      width: 28px;
      height: 24px;
    }

    .resize-btn {
      right: 6px;
      bottom: 6px;
      width: 26px;
      height: 26px;
      cursor: se-resize;
    }

    iframe {
      width: 100%;
      height: 100%;
      border: none;
      display: block;
    }
  </style>
</head>
<body>
  <div id="controls">
    <input id="urlInput" placeholder="Paste YouTube URL..." />
    <button id="addBtn">Add Video</button>
  </div>
  <div id="playerArea"></div>

  <!-- Interact.js -->
  <script src="https://cdn.jsdelivr.net/npm/interactjs/dist/interact.min.js"></script>
  <script>
    const playerArea = document.getElementById('playerArea');
    const input = document.getElementById('urlInput');
    const addBtn = document.getElementById('addBtn');

    function getVideoId(url) {
      const match = url.match(/(?:v=|youtu\.be\/|embed\/)([a-zA-Z0-9_-]{11})/);
      return match ? match[1] : null;
    }

    addBtn.addEventListener('click', () => {
      const id = getVideoId(input.value.trim());
      if (!id) { alert('Invalid YouTube URL'); return; }
      createVideoBox(id);
      input.value = '';
    });

    function createVideoBox(videoId) {
      const box = document.createElement('div');
      box.className = 'video-box';
      box.style.left = Math.random() * 120 + 'px';
      box.style.top  = Math.random() * 100 + 'px';

      const moveHandle = document.createElement('button');
      moveHandle.className = 'move-handle drag-handle';
      moveHandle.textContent = '☰';

      const closeBtn = document.createElement('button');
      closeBtn.className = 'close-btn';
      closeBtn.textContent = '×';
      closeBtn.onclick = () => box.remove();

      const resizeBtn = document.createElement('button');
      resizeBtn.className = 'resize-btn resize-handle';
      resizeBtn.textContent = '⇱';

      const iframe = document.createElement('iframe');
      iframe.src = `https://www.youtube.com/embed/${videoId}?enablejsapi=1`;
      iframe.allow =
        "accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture;";
      iframe.allowFullscreen = true;

      box.append(moveHandle, closeBtn, resizeBtn, iframe);
      playerArea.appendChild(box);
    }

    // Drag with boundary restriction
    interact('.video-box').draggable({
      allowFrom: '.drag-handle',
      modifiers: [
        interact.modifiers.restrictRect({
          restriction: '#playerArea',
          endOnly: true
        })
      ],
      listeners: {
        move(event) {
          const t = event.target;
          const x = (parseFloat(t.getAttribute('data-x')) || 0) + event.dx;
          const y = (parseFloat(t.getAttribute('data-y')) || 0) + event.dy;
          t.style.transform = `translate(${x}px, ${y}px)`;
          t.setAttribute('data-x', x);
          t.setAttribute('data-y', y);
        }
      }
    });

    // Resize with boundary restriction
    interact('.video-box').resizable({
      allowFrom: '.resize-handle',
      edges: { right: true, bottom: true },
      modifiers: [
        interact.modifiers.aspectRatio({
          ratio: 16/9,
          enforce: 'reposition'
        }),
        interact.modifiers.restrictEdges({
          outer: 'parent'
        })
      ],
      listeners: {
        move(event) {
          let x = parseFloat(event.target.getAttribute('data-x')) || 0;
          let y = parseFloat(event.target.getAttribute('data-y')) || 0;

          event.target.style.width  = event.rect.width + 'px';
          event.target.style.height = event.rect.height + 'px';

          x += event.deltaRect.left;
          y += event.deltaRect.top;

          event.target.style.transform = `translate(${x}px, ${y}px)`;
          event.target.setAttribute('data-x', x);
          event.target.setAttribute('data-y', y);
        }
      }
    });
  </script>
</body>
</html>
